# batファイルエンコード変換ツール - Python版 v1.1

このツールは、batファイルのエンコーディングをANSI（Windows環境ではCP932/Shift-JIS）に変換するためのPython製ユーティリティです。

**更新情報（v1.1）**: 
- 元のファイルの自動バックアップ機能を追加
- 変換エラー時の自動復元機能を実装
- 古いバックアップファイルの自動削除（最新5個を保持）

## 機能

- 個別のbatファイルまたはフォルダ内のすべてのbatファイルを変換可能
- エンコーディング自動検出機能
- ドラッグ＆ドロップによる簡単な操作
- サブフォルダを含めた再帰的な変換処理
- バッチファイルからも実行可能な環境構築
- **自動バックアップ機能**：変換前に元のファイルをバックアップ
- **エラー時復元機能**：変換失敗時に自動的に元のファイルを復元

## インストール

事前に必要なライブラリをインストールしてください：

```
pip install chardet
```

## 使用方法

### 1. 対話モードで実行

```
python batToAnsi.py
```

プログラムを起動し、変換したいファイルやフォルダのパスを入力します。

### 2. コマンドライン引数で実行

```
python batToAnsi.py C:\path\to\file.bat
```

または

```
python batToAnsi.py C:\path\to\folder
```

### 3. ドラッグ＆ドロップで実行

batファイルやフォルダを`batToAnsi.py`にドラッグ＆ドロップすることでも実行できます。

### 4. バッチファイルから実行 (Pythonをインストールしている場合)

```
run_batToAnsi.bat [ファイルパス/フォルダパス]
```

このバッチファイルは必要なライブラリをチェックし、Pythonスクリプトを実行します。引数なしで実行すると対話モードになります。

### 5. スタンドアロンEXEファイルの作成 (配布用)

```
build_exe.bat
```

このバッチファイルを実行すると、PyInstallerを使用してスタンドアロンの実行ファイル（exe）を作成します。作成されたexeファイルはPythonがインストールされていない環境でも実行可能です。

## 対応エンコーディング

以下のエンコーディングを自動検出して変換します：

- UTF-8（BOM付き）
- UTF-8（BOMなし）
- UTF-16 リトルエンディアン（LE）
- UTF-16 ビッグエンディアン（BE）
- その他のエンコーディング（chardetライブラリによる検出）

## 動作環境

- Python 3.6以上
- Windows環境（日本語）

## 注意事項

- **バックアップ機能**: 変換処理前に元のファイルが自動的にバックアップされます
  - バックアップファイル名: `元のファイル名.backup_日付時刻`
  - 最新5個のバックアップファイルが保持されます
  - 古いバックアップファイルは自動的に削除されます
- 変換処理中にエラーが発生した場合、自動的に元のファイルに復元されます
- エンコーディングの自動検出は100%正確ではありません
- 重要なファイルを変換する前に、追加でバックアップを取ることをお勧めします

## バックアップファイルについて

- バックアップファイルは元のファイルと同じフォルダに作成されます
- ファイル名の形式: `元のファイル名.backup_YYYYMMDD_HHMMSS`
- 例: `test.bat` → `test.bat.backup_20250530_143022`
- 最新5個のバックアップファイルのみが保持され、古いものは自動削除されます
